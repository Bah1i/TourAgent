-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Хост: 127.0.0.1
-- Время создания: Май 27 2023 г., 14:25
-- Версия сервера: 10.4.28-MariaDB
-- Версия PHP: 8.2.4

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- База данных: `turagent`
--

-- --------------------------------------------------------

--
-- Структура таблицы `review`
--

CREATE TABLE `review` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `sale_id` int(11) DEFAULT NULL,
  `rating` int(11) DEFAULT NULL,
  `description` text DEFAULT NULL,
  `date` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `review`
--

INSERT INTO `review` (`id`, `user_id`, `sale_id`, `rating`, `description`, `date`) VALUES
(8, 1, 31, 5, 'Не подарили ламборгини', '2023-05-27 03:01:14'),
(9, 1, 31, 2, 'Подарили жигули', '2023-05-27 03:01:38'),
(10, 2, 106, 4, 'Слетал на родину. Как будто и не уезжал из элитных районов Москвы. ВУА-ахаххха', '2023-05-27 07:18:16'),
(11, 2, 107, 3, 'Это че за вообще такое, за туалет целых 15 рублей.  Посмотрите под матрас, АХАХХА!', '2023-05-27 07:18:49'),
(12, 2, 108, 4, 'А мне подарили Волгу', '2023-05-27 07:19:01');

-- --------------------------------------------------------

--
-- Структура таблицы `sale`
--

CREATE TABLE `sale` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `tour_id` int(11) DEFAULT NULL,
  `ticket_id` int(11) DEFAULT NULL,
  `order_date` datetime NOT NULL,
  `cost` decimal(10,2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `sale`
--

INSERT INTO `sale` (`id`, `user_id`, `tour_id`, `ticket_id`, `order_date`, `cost`) VALUES
(2, 1, NULL, 2, '2023-05-26 06:53:22', 1000.00),
(3, 1, NULL, 2, '2023-05-26 06:55:29', 1000.00),
(4, 1, NULL, 2, '2023-05-26 06:56:06', 1000.00),
(5, 1, NULL, 2, '2023-05-26 06:56:38', 1000.00),
(6, 1, NULL, 2, '2023-05-26 06:57:29', 1000.00),
(7, 1, NULL, 2, '2023-05-26 06:58:11', 1000.00),
(8, 1, NULL, 2, '2023-05-26 06:59:27', 1000.00),
(9, 1, NULL, 2, '2023-05-26 07:00:59', 1000.00),
(10, 1, NULL, 2, '2023-05-26 07:03:35', 1000.00),
(11, 1, NULL, 2, '2023-05-26 07:07:02', 1000.00),
(12, 1, NULL, 2, '2023-05-26 07:08:10', 1000.00),
(13, 1, NULL, 2, '2023-05-26 07:10:18', 1000.00),
(14, 1, NULL, 2, '2023-05-26 07:11:34', 1000.00),
(15, 1, NULL, 2, '2023-05-26 07:14:10', 1010.00),
(16, 1, NULL, 2, '2023-05-26 07:18:10', 1020.10),
(17, 1, NULL, 2, '2023-05-26 07:18:21', 1030.30),
(18, 1, NULL, 2, '2023-05-26 07:26:02', 1040.60),
(19, 1, NULL, 2, '2023-05-26 07:28:10', 1051.01),
(20, 1, 1, NULL, '2023-05-26 07:31:47', 50000.00),
(21, 1, 1, NULL, '2023-05-26 07:45:56', 50000.00),
(22, 1, 1, NULL, '2023-05-26 07:46:15', 50000.00),
(23, 1, 1, NULL, '2023-05-26 08:34:49', 50000.00),
(24, 1, 1, NULL, '2023-05-26 08:35:12', 50000.00),
(25, 1, NULL, 2, '2023-05-26 08:37:06', 1061.52),
(26, 1, 1, NULL, '2023-05-26 09:05:04', 50000.00),
(27, 1, 1, NULL, '2023-05-26 09:06:42', 50000.00),
(28, 1, 1, NULL, '2023-05-26 09:11:37', 50000.00),
(29, 1, 1, NULL, '2023-05-26 09:14:06', 50000.00),
(30, 1, NULL, 2, '2023-05-26 10:04:43', 1072.14),
(31, 1, 2, NULL, '2023-05-27 03:00:59', 10.00),
(32, 1, NULL, 2, '2023-05-27 03:10:28', 1082.86),
(33, 1, NULL, 3, '2023-05-27 03:12:46', 2000.00),
(34, 1, NULL, 3, '2023-05-27 03:15:01', 2020.00),
(35, 1, NULL, 3, '2023-05-27 03:17:56', 2040.20),
(36, 1, NULL, 3, '2023-05-27 03:18:00', 2060.60),
(37, 1, NULL, 3, '2023-05-27 03:20:25', 2081.21),
(38, 1, 2, NULL, '2023-05-27 03:20:41', 10.00),
(39, 1, 2, NULL, '2023-05-27 03:22:08', 10.00),
(40, 1, 2, NULL, '2023-05-27 03:22:09', 10.00),
(41, 1, 2, NULL, '2023-05-27 03:22:10', 10.00),
(42, 1, 2, NULL, '2023-05-27 03:22:11', 10.00),
(43, 1, 2, NULL, '2023-05-27 03:22:11', 10.00),
(44, 1, 2, NULL, '2023-05-27 03:22:11', 10.00),
(45, 1, 2, NULL, '2023-05-27 03:22:12', 10.00),
(46, 1, 2, NULL, '2023-05-27 03:22:12', 10.00),
(47, 1, 2, NULL, '2023-05-27 03:22:12', 10.00),
(48, 1, 2, NULL, '2023-05-27 03:22:13', 10.00),
(49, 1, 2, NULL, '2023-05-27 03:22:19', 10.00),
(50, 1, NULL, 3, '2023-05-27 03:22:25', 2102.02),
(51, 1, 1, NULL, '2023-05-27 03:23:02', 50000.00),
(52, 1, 1, NULL, '2023-05-27 03:23:04', 50000.00),
(53, 1, 1, NULL, '2023-05-27 03:23:05', 50000.00),
(54, 1, 1, NULL, '2023-05-27 03:23:06', 50000.00),
(55, 1, NULL, 4, '2023-05-27 03:26:43', 2500.00),
(56, 1, NULL, 3, '2023-05-27 03:27:02', 2123.04),
(57, 1, NULL, 4, '2023-05-27 03:27:26', 2525.00),
(58, 1, 2, NULL, '2023-05-27 03:27:37', 10.00),
(59, 1, 2, NULL, '2023-05-27 03:27:37', 10.00),
(60, 1, 1, NULL, '2023-05-27 03:27:45', 50000.00),
(61, 1, NULL, 3, '2023-05-27 03:28:29', 2144.27),
(62, 1, NULL, 5, '2023-05-27 03:28:31', 2500.00),
(63, 1, NULL, 5, '2023-05-27 03:28:35', 2525.00),
(64, 1, NULL, 3, '2023-05-27 03:28:36', 2165.71),
(65, 1, NULL, 3, '2023-05-27 03:28:42', 2187.37),
(66, 1, NULL, 3, '2023-05-27 03:29:33', 2209.24),
(67, 1, NULL, 3, '2023-05-27 03:29:44', 2231.33),
(68, 1, NULL, 3, '2023-05-27 03:29:47', 2253.64),
(69, 1, NULL, 3, '2023-05-27 03:29:47', 2276.18),
(70, 1, NULL, 3, '2023-05-27 03:29:48', 2298.94),
(71, 1, NULL, 3, '2023-05-27 03:29:49', 2321.93),
(72, 1, NULL, 3, '2023-05-27 03:29:49', 2345.15),
(73, 1, NULL, 3, '2023-05-27 03:29:50', 2368.60),
(74, 1, NULL, 3, '2023-05-27 03:29:50', 2392.29),
(75, 1, NULL, 3, '2023-05-27 03:29:51', 2416.21),
(76, 1, NULL, 3, '2023-05-27 03:29:52', 2440.37),
(77, 1, NULL, 3, '2023-05-27 03:29:52', 2464.77),
(78, 1, NULL, 3, '2023-05-27 03:29:52', 2489.42),
(79, 1, NULL, 3, '2023-05-27 03:29:53', 2514.31),
(80, 1, NULL, 3, '2023-05-27 03:29:53', 2539.45),
(81, 1, 1, NULL, '2023-05-27 03:36:23', 50000.00),
(82, 1, 1, NULL, '2023-05-27 03:43:41', 50000.00),
(83, 1, 1, NULL, '2023-05-27 03:43:43', 50000.00),
(84, 1, NULL, 3, '2023-05-27 03:43:53', 2564.84),
(85, 1, 2, NULL, '2023-05-27 03:47:11', 10.00),
(86, 1, 2, NULL, '2023-05-27 03:47:24', 10.00),
(87, 1, NULL, 3, '2023-05-27 03:47:33', 2590.49),
(88, 1, NULL, 3, '2023-05-27 03:54:14', 2590.49),
(89, 1, NULL, 3, '2023-05-27 03:54:24', 2616.39),
(90, 1, NULL, 3, '2023-05-27 03:54:32', 2642.55),
(91, 1, NULL, 3, '2023-05-27 03:54:32', 2668.98),
(92, 1, NULL, 3, '2023-05-27 03:54:32', 2668.98),
(93, 1, NULL, 3, '2023-05-27 03:54:32', 2722.63),
(94, 1, NULL, 3, '2023-05-27 03:54:32', 2749.86),
(95, 1, NULL, 3, '2023-05-27 03:54:32', 2777.36),
(96, 1, NULL, 3, '2023-05-27 03:54:32', 2805.13),
(97, 1, NULL, 3, '2023-05-27 03:54:33', 2833.18),
(98, 1, NULL, 3, '2023-05-27 03:54:33', 2861.51),
(99, 1, NULL, 3, '2023-05-27 03:54:33', 2861.51),
(100, 1, NULL, 3, '2023-05-27 03:54:33', 2861.51),
(101, 1, NULL, 3, '2023-05-27 03:54:33', 2861.51),
(102, 1, NULL, 3, '2023-05-27 03:54:39', 2948.22),
(103, 1, NULL, 6, '2023-05-27 07:09:53', 10000.00),
(104, 1, NULL, 6, '2023-05-27 07:09:54', 10100.00),
(105, 1, NULL, 6, '2023-05-27 07:09:55', 10201.00),
(106, 2, NULL, 6, '2023-05-27 07:16:49', 10303.01),
(107, 2, 1, NULL, '2023-05-27 07:16:52', 50000.00),
(108, 2, 2, NULL, '2023-05-27 07:16:53', 10.00),
(109, 2, NULL, 6, '2023-05-27 10:53:21', 10406.04),
(110, 2, NULL, 3, '2023-05-27 10:53:22', 2977.70),
(111, 2, NULL, 6, '2023-05-27 10:53:28', 10510.10),
(112, 2, NULL, 6, '2023-05-27 10:53:29', 10615.20),
(113, 2, NULL, 6, '2023-05-27 10:53:31', 10721.35),
(114, 2, 2, NULL, '2023-05-27 10:54:13', 10.00),
(115, 2, 2, NULL, '2023-05-27 10:54:13', 10.00),
(116, 1, NULL, 3, '2023-05-27 10:57:12', 3007.48),
(117, 1, NULL, 4, '2023-05-27 10:57:13', 2550.25),
(118, 1, NULL, 5, '2023-05-27 10:57:14', 2550.25),
(119, 1, NULL, 6, '2023-05-27 10:57:14', 10828.56),
(120, 1, NULL, 6, '2023-05-27 10:57:15', 10936.85),
(121, 1, NULL, 5, '2023-05-27 10:57:16', 2575.75),
(122, 1, NULL, 4, '2023-05-27 10:57:16', 2575.75),
(123, 1, NULL, 3, '2023-05-27 10:57:16', 3037.55),
(124, 1, NULL, 6, '2023-05-27 10:57:21', 11046.22),
(125, 1, NULL, 6, '2023-05-27 10:57:21', 11156.68),
(126, 1, NULL, 6, '2023-05-27 10:57:22', 11268.25),
(127, 1, NULL, 6, '2023-05-27 10:57:22', 11380.93),
(128, 1, NULL, 6, '2023-05-27 10:57:25', 11494.74),
(129, 1, NULL, 5, '2023-05-27 10:57:26', 2601.51),
(130, 1, NULL, 4, '2023-05-27 10:57:26', 2601.51),
(131, 2, 2, NULL, '2023-05-27 10:59:02', 10.00),
(132, 2, 2, NULL, '2023-05-27 10:59:07', 10.00),
(133, 2, 2, NULL, '2023-05-27 10:59:08', 10.00),
(134, 2, 2, NULL, '2023-05-27 10:59:08', 10.00),
(135, 2, 2, NULL, '2023-05-27 10:59:08', 10.00),
(136, 2, 2, NULL, '2023-05-27 10:59:09', 10.00),
(137, 2, 2, NULL, '2023-05-27 11:00:38', 10.00),
(138, 2, 2, NULL, '2023-05-27 11:00:42', 10.00),
(139, 2, NULL, 3, '2023-05-27 11:00:45', 3067.93),
(140, 2, NULL, 4, '2023-05-27 11:00:47', 2627.53),
(141, 2, NULL, 5, '2023-05-27 11:00:47', 2627.53),
(142, 2, NULL, 6, '2023-05-27 11:00:48', 11609.69),
(143, 2, NULL, 5, '2023-05-27 11:00:48', 2653.81),
(144, 2, NULL, 4, '2023-05-27 11:00:49', 2653.81),
(145, 2, NULL, 3, '2023-05-27 11:00:49', 3098.61),
(146, 1, NULL, 6, '2023-05-27 11:03:22', 11725.79),
(147, 1, NULL, 5, '2023-05-27 11:03:24', 2680.35),
(148, 1, NULL, 4, '2023-05-27 11:03:25', 2680.35),
(149, 1, NULL, 3, '2023-05-27 11:03:25', 3129.60),
(150, 2, 2, NULL, '2023-05-27 11:05:17', 10.00),
(151, 2, 2, NULL, '2023-05-27 11:05:19', 10.00),
(152, 2, 2, NULL, '2023-05-27 11:05:19', 10.00),
(153, 2, 2, NULL, '2023-05-27 11:05:19', 10.00),
(154, 2, 2, NULL, '2023-05-27 11:05:20', 10.00),
(155, 2, 2, NULL, '2023-05-27 11:05:20', 10.00),
(156, 2, 2, NULL, '2023-05-27 11:05:20', 10.00),
(157, 2, 2, NULL, '2023-05-27 11:05:20', 10.00),
(158, 1, NULL, 6, '2023-05-27 11:58:58', 11843.05),
(159, 1, NULL, 5, '2023-05-27 11:59:00', 2707.15),
(160, 1, NULL, 3, '2023-05-27 11:59:11', 3160.90),
(161, 1, NULL, 3, '2023-05-27 11:59:13', 3192.51),
(162, 1, NULL, 5, '2023-05-27 12:02:21', 2734.22),
(163, 1, NULL, 4, '2023-05-27 12:02:22', 2707.15),
(164, 1, NULL, 3, '2023-05-27 12:02:23', 3224.44),
(165, 1, NULL, 3, '2023-05-27 12:02:37', 3256.68),
(166, 1, NULL, 4, '2023-05-27 12:02:38', 2734.22),
(167, 1, NULL, 5, '2023-05-27 12:02:39', 2761.56),
(168, 1, NULL, 6, '2023-05-27 12:02:39', 11961.48),
(169, 1, NULL, 5, '2023-05-27 12:02:50', 2789.18),
(170, 1, NULL, 5, '2023-05-27 12:02:57', 2817.07),
(171, 2, NULL, 3, '2023-05-27 12:06:17', 3289.25),
(172, 2, NULL, 4, '2023-05-27 12:06:18', 2761.56),
(173, 2, NULL, 5, '2023-05-27 12:06:19', 2845.24),
(174, 2, NULL, 6, '2023-05-27 12:06:19', 12081.09);

-- --------------------------------------------------------

--
-- Структура таблицы `ticket`
--

CREATE TABLE `ticket` (
  `id` int(11) NOT NULL,
  `flight_number` varchar(50) NOT NULL,
  `departure_city` varchar(50) NOT NULL,
  `arrival_city` varchar(50) NOT NULL,
  `cost` decimal(10,2) NOT NULL,
  `count` int(11) DEFAULT NULL,
  `departure_date` datetime DEFAULT NULL,
  `departure_time` time DEFAULT NULL,
  `arrival_date` datetime DEFAULT NULL,
  `arrival_time` time DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `ticket`
--

INSERT INTO `ticket` (`id`, `flight_number`, `departure_city`, `arrival_city`, `cost`, `count`, `departure_date`, `departure_time`, `arrival_date`, `arrival_time`) VALUES
(2, 'S7-3344', 'Иркутск', 'Братск', 1093.69, 0, '2023-05-26 00:00:00', '14:26:00', '2023-05-27 00:00:00', '17:22:00'),
(3, 'S7-1232', 'Иркутск', 'Томск', 3322.14, 149, '2023-05-27 00:00:00', '17:51:00', '2023-05-27 00:00:00', '22:52:00'),
(4, 'S7-1233', 'Томск', 'Казань', 2789.18, 159, '2023-05-27 00:00:00', '23:52:00', '2023-05-27 00:00:00', '23:58:00'),
(5, 'S7-3345', 'Иркутск', 'Москва', 2873.69, 153, '2023-05-27 00:00:00', '18:10:00', '2023-05-27 00:00:00', '19:10:00'),
(6, 'Air-Arabia 777-777', 'Иркутск', 'Дубай', 12201.90, 217, '2023-06-06 00:00:00', '20:00:00', '2023-06-06 00:00:00', '22:00:00');

-- --------------------------------------------------------

--
-- Структура таблицы `tour`
--

CREATE TABLE `tour` (
  `id` int(11) NOT NULL,
  `name` varchar(50) NOT NULL,
  `description` text DEFAULT NULL,
  `cost` decimal(10,2) NOT NULL,
  `start_date` datetime DEFAULT NULL,
  `end_date` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `tour`
--

INSERT INTO `tour` (`id`, `name`, `description`, `cost`, `start_date`, `end_date`) VALUES
(1, 'f', 'f', 50000.00, '2023-05-11 07:31:00', '2023-06-02 07:31:00'),
(2, 'Мечта султана', 'Бюджетные шейхи', 10.00, '2023-05-28 03:00:00', '2023-05-31 03:00:00'),
(3, 'Казахское ОПГ', 'Че да', 1000.00, '2023-05-28 12:13:00', '2023-06-04 12:13:00');

-- --------------------------------------------------------

--
-- Структура таблицы `tour_img`
--

CREATE TABLE `tour_img` (
  `id` int(11) NOT NULL,
  `tour_id` int(11) NOT NULL,
  `link` varchar(200) DEFAULT NULL,
  `mime_type` varchar(25) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `tour_img`
--

INSERT INTO `tour_img` (`id`, `tour_id`, `link`, `mime_type`) VALUES
(1, 2, '10e5a98a-c027-4dac-9b6f-1887b62cbfa9.png', 'image/png');

-- --------------------------------------------------------

--
-- Структура таблицы `user`
--

CREATE TABLE `user` (
  `id` int(11) NOT NULL,
  `firstname` varchar(50) NOT NULL,
  `lastname` varchar(50) NOT NULL,
  `patronymic` varchar(50) DEFAULT NULL,
  `email` varchar(50) NOT NULL,
  `password` varchar(200) NOT NULL,
  `role` enum('Пользователь','Администратор') NOT NULL,
  `phone` varchar(50) DEFAULT NULL,
  `balance` decimal(10,2) NOT NULL DEFAULT 0.00
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--
-- Дамп данных таблицы `user`
--

INSERT INTO `user` (`id`, `firstname`, `lastname`, `patronymic`, `email`, `password`, `role`, `phone`, `balance`) VALUES
(1, 'Баха', 'Джангиров', NULL, 'admin@gmail.com', '$2a$10$XmJkVaW14XTUG7CtSMjh/eBChTaaSKr/5sFXqISgpbRNmm2XcM1U6', 'Администратор', NULL, 966579.70),
(2, 'Юзер', 'Ибн Юзер', 'Салам', 'user@gmail.com', '$2a$10$sc8z8Y7fxPS7YdFnMoIN8OKatFzyLLVXudg16iONm7kjchHEAk/WK', 'Пользователь', '111-111', 959960.55);

--
-- Индексы сохранённых таблиц
--

--
-- Индексы таблицы `review`
--
ALTER TABLE `review`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `sale_id` (`sale_id`);

--
-- Индексы таблицы `sale`
--
ALTER TABLE `sale`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `tour_id` (`tour_id`),
  ADD KEY `ticket_id` (`ticket_id`);

--
-- Индексы таблицы `ticket`
--
ALTER TABLE `ticket`
  ADD PRIMARY KEY (`id`);

--
-- Индексы таблицы `tour`
--
ALTER TABLE `tour`
  ADD PRIMARY KEY (`id`);

--
-- Индексы таблицы `tour_img`
--
ALTER TABLE `tour_img`
  ADD PRIMARY KEY (`id`),
  ADD KEY `tour_id` (`tour_id`);

--
-- Индексы таблицы `user`
--
ALTER TABLE `user`
  ADD PRIMARY KEY (`id`);

--
-- AUTO_INCREMENT для сохранённых таблиц
--

--
-- AUTO_INCREMENT для таблицы `review`
--
ALTER TABLE `review`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=13;

--
-- AUTO_INCREMENT для таблицы `sale`
--
ALTER TABLE `sale`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=175;

--
-- AUTO_INCREMENT для таблицы `ticket`
--
ALTER TABLE `ticket`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT для таблицы `tour`
--
ALTER TABLE `tour`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT для таблицы `tour_img`
--
ALTER TABLE `tour_img`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT для таблицы `user`
--
ALTER TABLE `user`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- Ограничения внешнего ключа сохраненных таблиц
--

--
-- Ограничения внешнего ключа таблицы `review`
--
ALTER TABLE `review`
  ADD CONSTRAINT `review_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE,
  ADD CONSTRAINT `review_ibfk_2` FOREIGN KEY (`sale_id`) REFERENCES `sale` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE;

--
-- Ограничения внешнего ключа таблицы `sale`
--
ALTER TABLE `sale`
  ADD CONSTRAINT `sale_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE,
  ADD CONSTRAINT `sale_ibfk_2` FOREIGN KEY (`tour_id`) REFERENCES `tour` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  ADD CONSTRAINT `sale_ibfk_3` FOREIGN KEY (`ticket_id`) REFERENCES `ticket` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Ограничения внешнего ключа таблицы `tour_img`
--
ALTER TABLE `tour_img`
  ADD CONSTRAINT `tour_img_ibfk_1` FOREIGN KEY (`tour_id`) REFERENCES `tour` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
